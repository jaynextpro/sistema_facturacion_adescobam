<script type="module">
    $(document).ready(function() {
        // Function to format phone number
        function formatPhoneNumber($input) {
            var cleaned = $input.val().replace(/\D/g, '');
            var formatted = '';

            if (cleaned.length > 0) {
                formatted = '(' + cleaned.substring(0, 3);
                if (cleaned.length > 3) {
                    formatted += ') ' + cleaned.substring(3, 6);
                }
                if (cleaned.length > 6) {
                    formatted += '-' + cleaned.substring(6, 10);
                }
            }

            $input.val(formatted);
        }

        if($('#pdPhoneNumber').length > 0) {
            formatPhoneNumber($('#pdPhoneNumber'));

            $('#pdPhoneNumber').on('input', function() {
                formatPhoneNumber($(this));
            });
        }
        
        $('.modal-toggle').on('click', function(e) {
            e.preventDefault();
            var this_attr = $(this).data('target');
            $('#'+this_attr).toggleClass('show');       
            $('body').toggleClass('modal-open');                
        });

        $(document).keyup(function(event){
            if(event.keyCode == 27 && $('body').hasClass('modal-open') && $('.modal').hasClass('show')) {
                $('.modal').removeClass('show');
                $('body').removeClass('modal-open');
            }
        });

        <% if flash[:test_alert].present? %>
            $('#testErrorModal .modal-heading').html('Notice'); 
            $('#testErrorModal .modal-content p').html('<%= flash[:test_alert] %>'); 

            $('#testErrorModal').addClass('show');
            $('body').addClass('modal-open');
        <% end %>

        <% if flash[:alert].present? || @promo_registration.try(:errors).present? || @sweep_entry.try(:errors).present? %>
            $('html, body').animate({
                scrollTop: $("form").offset().top
            }, 500);
        <% end %>

        $('select').niceSelect();
    });
</script>